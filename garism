Sub DOSChecker()
    Dim ws As Worksheet
    Dim effDate As Variant
    Dim dosDate As Variant

    '=== Reference the sheet ===
    Set ws = ThisWorkbook.Sheets("Plan Checker")

    '=== Get dates ===
    effDate = ws.Range("A2").Value   ' Effective Date
    dosDate = ws.Range("K2").Value   ' Date of Service

    '=== Validate both cells contain valid dates ===
    If Not IsDate(effDate) Or Not IsDate(dosDate) Then
        ws.Range("L2").Value = "Invalid date(s)"
        Exit Sub
    End If

    '=== Compare Effective vs DOS ===
    If effDate <= dosDate Then
        ws.Range("L2").Value = "Active"
    Else
        ws.Range("L2").Value = "Inactive"
    End If
End Sub
