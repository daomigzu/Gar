Sub DeleteExtraRows_PlanChecker()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim deleteFrom As Long

    On Error Resume Next
    Set ws = ThisWorkbook.Sheets("Plan Checker")
    On Error GoTo 0

    If ws Is Nothing Then
        MsgBox "❌ Sheet 'Plan Checker' not found!", vbCritical
        Exit Sub
    End If

    '=== Find last used row in columns A:F ===
    On Error Resume Next
    lastRow = ws.Range("A:F").Find(What:="*", _
                                   After:=ws.Range("A1"), _
                                   LookIn:=xlValues, _
                                   LookAt:=xlPart, _
                                   SearchOrder:=xlByRows, _
                                   SearchDirection:=xlPrevious, _
                                   MatchCase:=False).Row
    On Error GoTo 0

    If lastRow = 0 Then
        MsgBox "⚠️ No data found in columns A:F.", vbExclamation
        Exit Sub
    End If

    '=== Calculate start row for deletion ===
    deleteFrom = lastRow + 1

    '=== Delete actual rows (not just clear) ===
    With ws
        If deleteFrom <= .Rows.Count Then
            .Range("A" & deleteFrom & ":F" & .Rows.Count).EntireRow.Delete
        End If
    End With

    MsgBox "✅ Deleted all rows with data in columns A:F after row " & lastRow & ".", vbInformation, "Plan Checker Cleanup"
End Sub
